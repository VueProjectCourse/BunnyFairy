# 购物车功能分析

::: tip 目标
这一小节，我们的目标是了解购物车功能的实现逻辑
:::

::: warning 步骤

1. 购物车功能
:::

::: info 体验

* **Kn.1：购物车功能**

  * 应用中的购物车分为两种，一种是本地购物车，一种是服务器中的购物车，在用户未登录状态下操作的是本地购物车，在用户登录状态下，操作的是服务器中的购物车
  * 无论是操作本地购物车还是操作服务器端购物车，操作本身都是在 Store中进行的，组件不需要关心操作的是哪个购物车，它只需要触发action方法即可，而且组件中的购物车数据也统一在Store中获取
  * 操作本地购物车是同步的，操作服务器中的购物车是异步的，为使组件能够以统一的方式获取API返回的结果，和购物车操作相关的方法统一返回Promise
  * 用户登录后，将本地购物车数据合并到服务器端，删除本地购物车数据，再将最新的服务器端购物车数据同步到本地
  * 用户退出后，需要清空本地购物车，因为本地购物车中的数据已经同步到服务器了
  * 本地购物车中的数据存储在 localstorage中，由于Store的持久化插件可以实现把数据同步到本地存储中，所以对于操作本地购物车而言，不需要除store操作以外的操作

  ![58](./images/58.png)
:::

::: danger 总结

* 【重点】
* 【难点】
* 【注意点】
:::
